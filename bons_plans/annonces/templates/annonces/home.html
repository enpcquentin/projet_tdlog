{% extends "base.html" %}
{% load static %}

{% block title %} Page d'accueil {% endblock %}

{% block timeline %}

<div id="bloc_page">
<div id="banniere_image">
    <div id="banniere_description">
        <strong> Derni√®re annonce parue : </strong> <br>
          {% if annonce %}
            {% for a in annonce %}
              <strong> Titre : </strong> {{ a.titre }} <br>
              <strong> Descriptif : </strong> {{ a.descriptif }}
            {% endfor %}
          {% else %}
            Il n'y a aucune annonce ...
          {% endif %}
    </div>
</div>
</div>

{% endblock %}

{% block content %}

  <body>
    <div id="mapDiv" style="width: 600px; height: 400px;"></div>
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDCz7usmwU_bwE46NxmQlKepw5a0GF2IYA&sensor=false"></script>
    <script>
      // coordonnees de Paris
      var paris = new google.maps.LatLng(48.856578, 2.351828);

      // recuperation de l'element HTML sur lequel afficher la carte
      var mapCanvas = document.getElementById("mapDiv");

      // creation effective de la carte
      var mapOptions = {
        center: paris,
        zoom: 10,
        mapTypeId: google.maps.MapTypeId.ROADMAP
      };
      var map = new google.maps.Map(mapCanvas, mapOptions);

     function addInfoWindowToMarker(map, marker, content_bulle) {
    var infoWindow = new google.maps.InfoWindow({
        content: content_bulle
    });
    google.maps.event.addListener(marker, 'click', function() {
        infoWindow.open(map,this)
    });
}



      {% for profil in profils %}
      // definition du marqueur et ajout a la carte
      var lieu = new google.maps.LatLng({{profil.lat | stringformat:"f"}}, {{profil.long | stringformat:"f"}});
      var markOptions = {
        position: lieu,
        map: map,
        title: "voir le profil"
      };
      var mark = new google.maps.Marker(markOptions);
      addInfoWindowToMarker(map, mark, "{{profil.user.username}}");

      // lien entre le marqueur et la fonction
      {% endfor %}






    </script>

  </body>

  {% endblock %}
